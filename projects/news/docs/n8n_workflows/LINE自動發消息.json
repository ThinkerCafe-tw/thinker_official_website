{
  "name": "LINEè‡ªå‹•ç™¼æ¶ˆæ¯",
  "nodes": [
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/reply",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $input.first().json }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1328,
        0
      ],
      "id": "fd806e65-cc1d-4420-9e74-cbd0edb9c6ef",
      "name": "HTTP Request",
      "credentials": {
        "httpBearerAuth": {
          "id": "ZgFvcp5F9qBTsPIc",
          "name": "Bearer Auth account"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "webhook",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        0,
        0
      ],
      "id": "00eb9906-9797-4ae0-bfd1-36b16afb3221",
      "name": "Webhook",
      "webhookId": "61011b30-5569-4c6d-b5b6-b06d33b82126"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6893db9f-80ed-43b3-81d0-7c9b92410506",
              "leftValue": "={{ $json.isNewsRequest }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        416,
        0
      ],
      "id": "1b8c1695-5c7c-484f-8c16-823d09fc13b1",
      "name": "If"
    },
    {
      "parameters": {
        "url": "https://raw.githubusercontent.com/ThinkerCafe-tw/thinker-news/main/latest.json",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        704,
        -80
      ],
      "id": "c78b11aa-1c02-4d2c-916b-c7a268122111",
      "name": "å–å¾—æ–°è JSON"
    },
    {
      "parameters": {
        "jsCode": "const body = $input.first().json.body;\nconst events = body.events || [];\n\n// æ²’æœ‰äº‹ä»¶å°±åœæ­¢åŸ·è¡Œ\nif (events.length === 0) {\n  return [];\n}\n\nconst event = events[0];\n\n// åªè™•ç†æ–‡å­—è¨Šæ¯\nif (event.type !== 'message' || event.message?.type !== 'text') {\n  return [];\n}\n\nconst userMessage = event.message.text.trim().toLowerCase();\nconst replyToken = event.replyToken;\n\n// åˆ¤æ–·æ˜¯å¦ç‚ºè§¸ç™¼é—œéµå­—\nconst triggers = ['/news', '/æ–°è', 'æ–°è', 'news', '/ä»Šæ—¥æ–°è', 'ğŸ“°'];\nconst isNewsRequest = triggers.includes(userMessage);\n\nreturn [{\n  json: {\n    replyToken: replyToken,\n    isNewsRequest: isNewsRequest,\n    userMessage: userMessage\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        208,
        0
      ],
      "id": "f568dc8b-bbb4-4bbf-80a1-189e71698391",
      "name": "éæ¿¾å™¨"
    },
    {
      "parameters": {
        "jsCode": "// å¾ GitHub JSON å–å¾—æ–°èè³‡æ–™\nconst rawData = $input.first().json;\n\n// è§£æ data å­—ä¸²ç‚º JSON ç‰©ä»¶\nconst newsData = JSON.parse(rawData.data);\n\n// å¾ã€Œéæ¿¾å™¨ã€ç¯€é»å–å¾— replyToken\nconst replyToken = $('éæ¿¾å™¨').first().json.replyToken;\n\n// çµ„è£å®Œæ•´å›è¦†è¨Šæ¯\nconst finalText = `${newsData.line_content}\\n\\nğŸ”— å®Œæ•´å…§å®¹ï¼š${newsData.website_url}\\n\\nâ° æ›´æ–°æ™‚é–“ï¼š${newsData.generated_at.substring(0, 16).replace('T', ' ')}`;\n\nreturn [{\n  json: {\n    replyToken: replyToken,\n    messages: [\n      {\n        type: \"text\",\n        text: finalText\n      }\n    ]\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        912,
        -80
      ],
      "id": "15c16298-a7a3-4b78-a829-2f1d7ff9897b",
      "name": "çµ„è£å›è¦†"
    }
  ],
  "pinData": {},
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "éæ¿¾å™¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "å–å¾—æ–°è JSON",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å–å¾—æ–°è JSON": {
      "main": [
        [
          {
            "node": "çµ„è£å›è¦†",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "éæ¿¾å™¨": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "çµ„è£å›è¦†": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "b245baad-c34d-4c8c-976c-2c30f2f79420",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "d2ad6cc6dc1ad746c21a8aba99ca68da57c7faef892a0442084b99584bcd9da6"
  },
  "id": "z17SlPgFyN5mv2h7",
  "tags": []
}